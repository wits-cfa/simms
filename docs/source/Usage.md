
[Draft]

SIMMS is a powerful simulation framework built around two key tools: `telsim` and `skysim`.

- **`telsim`**: Creates an empty Measurement Set (MS).
- **`skysim`**: Populates this MS by simulating visibilities, given a sky model. `skysim` also has an addtional feature that lets you add or subtract from an existing data column. 

### Basic Simulation

The simplest way to run a simulation:
```bash
skysim --ms smallvis.ms --catalogue skymodel.txt --column SIMULATED_DATA --sefd 421
```

Let's break down what this command does:
- `--ms smallvis.ms`: The MS where visibilities will be stored: You should already have the MS created (e.g., using `telsim`)
- `--catalogue skymodel.txt`: Your source catalogue containing the sky model
- `--column SIMULATED_DATA`: The column where simulated visibilities will be written
- `--sefd 421`: Adds thermal noise based on this System Equivalent Flux Density (SEFD) value

### Common Use Cases

1. **Using PyBDSF Catalogue**:
If your source catalogue is generated by PyBDSF:
   ```bash
   skysim --ms smallvis.ms --catalogue pybdsf.txt --cat-species bdsf_gaul --column SIMULATED_DATA
   ```
   - `--cat-species` specifies the catalogue type. This automatically uses the correct mapping for PyBDSF catalogue. You have to specify `--cat-species` if the catalogue is diffrent from the default. 
  
### Subtracting from or Adding to an Existing Column

You can subtract or add a simulated data (or any data you already have) from/to an existing column in the MS. 

**Steps:**

1. **Simulate the data using the basic simulation command**

2. **Add or Subtract to Existing Data**:
You only need to specify the simulated column and the target column to add or subtract assuming both already exists.  

   ```bash
   skysim --ms smallvis.ms --sc SIMULATED_DATA --ic CORRECTED_DATA --column RESIDUALS --mode add 
   ```
   ```bash
   skysim --ms smallvis.ms --sc SIMULATED_DATA --ic CORRECTED_DATA --column RESIDUALS --mode subtract 
   ```
Where: 
- `--sc` - is simulated column (The name `Simulated`is an example assuming you will be using a column you just simulated, but it can be any column you choose to add or subtract)
- `--ic` - is the input column you want to subtract/add from
- `column` - in the add/subtract case, is the column where your residuals will be saved at
- `mode:` specifies whether to add/subtract or simulate (the default is simulate: skysim will just simulate if mode is not specified)


